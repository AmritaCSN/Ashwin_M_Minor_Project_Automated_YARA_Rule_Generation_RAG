rule NewMalwareSample {
    meta:
        description = "Detects the new malware sample 15d5be42969f8c721f755e17bacdce7a02d12838134d441b1a99bcdee928bd85"
        author = "Malware Analyst"
        date = "2023-10-01"
        sha256 = "15d5be42969f8c721f755e17bacdce7a02d12838134d441b1a99bcdee928bd85"
    
    strings:
        $api1 = "cisqrt"
        $api2 = "cisin"
        $api3 = "cicos"
        $api4 = "adjfptan"
        $api5 = "vbafreevar"
        $api6 = "vbafreevarlist"
        $api7 = "adjfdivm64"
        $api8 = "vbafreeobjlist"
        $api9 = "adjfprem1"
        $api10 = "vbahresultcheckobj"
        $api11 = "vbaarydestruct"
        $api12 = "adjfdivm16i"
        $api13 = "vbaobjsetaddref"
        $api14 = "adjfpatan"
        $api15 = "cilog"
    condition:
        all of ($api*) and
        uint16(0) == 0x5A4D and  // MZ magic bytes
        filesize < 200KB
}