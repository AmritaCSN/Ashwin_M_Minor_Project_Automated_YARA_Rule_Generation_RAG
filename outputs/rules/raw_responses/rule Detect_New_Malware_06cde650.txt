rule Detect_New_Malware_06cde650
{
    meta:
        description = "Detects text-log based malware sample 06cde650 and neighbors using specific API and DLL indicators related to graphics and variant handling."
        author = "malware-analyst"
        sha256 = "06cde650baa0c78fe43d0088f1948c7654a0330f6f59822332ccf5d90fafb120"
        created = "2023-10-27"

    strings:
        // Behavioral Indicators (APIs from new sample and neighbors)
        $api_getsyscolorbrush = "getsyscolorbrush"
        $api_variantchangetypeex = "variantchangetypeex"
        
        // Contextual APIs (Present in target but common, use for context only)
        $api_getprocaddress = "getprocaddress"
        $api_getmodulehandlea = "getmodulehandlea"
        $api_raiseexception = "raiseexception"
        $api_loadlibrarya = "loadlibrarya"

        // Imported DLLs
        $dll_oleaut32 = "oleaut32.dll"
        $dll_user32 = "user32.dll"
        $dll_kernel32 = "kernel32.dll"

        // Benign Filter strings (to avoid) - Implicitly handled by selection of specific APIs above which are absent in benign context provided.
        // However, explicit exclusion of purely generic combos is good practice if rule matches broadly. 
        // Based on provided negative context, the above APIs are not present.

    condition:
        // Logic: 
        // 1. Must include specific DLLs found in target (oleaut32, user32) AND strong unique API indicators.
        // 2. The combination of GetSysColorBrush and VariantChangeTypeEx along with standard loading APIs is the specific behavior pattern to match, absent in the provided benign samples.
        
        $dll_oleaut32 and $dll_user32 and $dll_kernel32 and
        $api_getsyscolorbrush and $api_variantchangetypeex and
        ($api_getprocaddress or $api_getmodulehandlea or $api_raiseexception or $api_loadlibrarya)
}