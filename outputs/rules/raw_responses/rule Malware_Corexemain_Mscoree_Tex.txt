rule Malware_Corexemain_Mscoree_TextLog
{
    meta:
        author = "assistant"
        description = "Text-log detection for a malware family observed importing mscoree.dll and referencing corexemain with a 16xxxxxxxx TimeDateStamp (matches malicious neighbors, excludes listed benigns)."
        reference_sha256 = "3f2779d20014902628cfe7d01cd12cfec336d9d858aaa04b06148e7b998b379a"
        date = "2025-12-01"
        confidence = 80
    strings:
        $s_corexemain       = "corexemain"
        $s_mscoree          = "mscoree.dll"
        $s_num_sections_3   = "NumberOfSections is 3"
        $s_opt_hdr_224      = "SizeOfOptionalHeader is 224"
        /* Match TimeDateStamp values beginning with 16 (10-digit epoch starting with 16xxxxxxx) */
        $re_tds_16          = /TimeDateStamp is 16[0-9]{7}/
    condition:
        all of ($s_corexemain, $s_mscoree) and $re_tds_16 and $s_num_sections_3 and $s_opt_hdr_224
}
