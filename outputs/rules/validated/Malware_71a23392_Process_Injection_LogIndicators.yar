rule Malware_71a23392_Process_Injection_LogIndicators
{
    meta:
        author = "malware-analyst"
        description = "Text-log rule: flags combination of CreateProcess + WriteProcessMemory with runtime/timing or exception context indicators (likely process injection / self-modifying behavior). Excludes generic DLL names to avoid benign hits."
        sha256 = "71a23392365192b43b1689b784e7bf7561ad95c6aa0432e6c4635e17e63b1b9d"
        created = "2025-11-30"
        tlp = "WHITE"

    strings:
        $create_proc        = "createprocessw" nocase
        $write_proc_mem     = "writeprocessmemory" nocase
        $tickcount64        = "gettickcount64" nocase
        $current_exc        = "currentexception" nocase
        $current_exc_ctx    = "currentexceptioncontext" nocase

    condition:
        // require explicit process-creation + remote-write indicator
        $create_proc and $write_proc_mem
        // plus at least one runtime/exception string to reduce false positives
        and ( $tickcount64 or $current_exc or $current_exc_ctx )
}
