rule Malware_a7b031aa_detection
{
    meta:
        author = "malware-analyst"
        description = "Text-log detection for sample SHA256 a7b031aabbeb... â€” looks for the rare combination of disk-space query + status-text drawing APIs together with .NET runtime presence (text-only). Tuned to avoid benign UI/runtime hits."
        sha256 = "a7b031aabbeb5da007dea0cedb319cd604ab055a14660993365cc0cb6ac6f575"
        created = "2025-11-30"
        tlp = "WHITE"

    strings:
        $s_diskfree    = "shgetdiskfreespacea" nocase
        $s_drawstatus  = "drawstatustextw" nocase
        $s_releasedc   = "releasedc" nocase
        $s_mscoree     = "mscoree.dll" nocase

    condition:
        $s_diskfree and $s_drawstatus and $s_mscoree
        and ( $s_releasedc )   // now referenced
}
